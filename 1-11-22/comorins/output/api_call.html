<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <form>
        <label>Name</label> <input onkeyup="addDetails('name',this.value)" type="text"><br><br>
        <label>email:</label><input onkeyup="addDetails('email',this.value)" type="email"><br><br>
        <label>mobile_no</label><input onkeyup="addDetails('mobile_no',this.value)" type="number"><br><br>
        skills: <input onkeyup="addDetails('skills',this.value,0)" type="text">
                <input onkeyup="addDetails('skills',this.value,1)" type="text">
                <input onkeyup="addDetails('skills',this.value,2)" type="text">
        <h4>education:</h4>
        <table>
            <thead>
                <tr>
                    <td>#</td>
                    <td>course</td>
                    <td>years</td>
                    <td>Institute</td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td><input type="text" onkeyup="addDetails('education',this.value,0,'qualification')"/></td>
                    <td><input type="text" onkeyup="addDetails('education',this.value,0,'year')"/></td>
                    <td><input type="text" onkeyup="addDetails('education',this.value,0,'Institute')"/></td>
                </tr>
                <tr>
                    <td>2</td>
                    <td><input type="text" onkeyup="addDetails('education',this.value,1,'qualification')"/></td>
                    <td><input type="text" onkeyup="addDetails('education',this.value,1,'year')"/></td>
                    <td><input type="text" onkeyup="addDetails('education',this.value,1,'Institute')"/></td>
                </tr>
                <tr>
                    <td>3</td>
                    <td><input type="text" onkeyup="addDetails('education',this.value,2,'qualification')"/></td>
                    <td><input type="text" onkeyup="addDetails('education',this.value,2,'year')"/></td>
                    <td><input type="text" onkeyup="addDetails('education',this.value,2,'Institute')"/></td>
                </tr>
                <tr>
                    <td>4</td>
                    <td><input type="text" onkeyup="addDetails('education',this.value,3,'qualification')"/></td>
                    <td><input type="text" onkeyup="addDetails('education',this.value,3,'year')"/></td>
                    <td><input type="text" onkeyup="addDetails('education',this.value,3,'Institute')"/></td>
                </tr>
            </tbody>
        </table>
        <h4>certification:</h4>
        <table>
            <thead>
                <tr>
                    <td>#</td>
                    <td>course</td>
                    <td>duration</td>
                    <td>institute</td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td><input type="text" onkeyup="addDetails('certification',this.value,0,'course')"></td>
                    <td><input type="text" onkeyup="addDetails('certification',this.value,0,'duration')"></td>
                    <td><input type="text" onkeyup="addDetails('certification',this.value,0,'Institute')"></td>
                </tr>
                <tr>
                    <td>2</td>
                    <td><input type="text" onkeyup="addDetails('certification',this.value,1,'course')"></td>
                    <td><input type="text" onkeyup="addDetails('certification',this.value,1,'duration')"></td>
                    <td><input type="text" onkeyup="addDetails('certification',this.value,1,'Institute')"></td>
                </tr>
                <tr>
                    <td>3</td>
                    <td><input type="text" onkeyup="addDetails('certification',this.value,2,'course')"></td>
                    <td><input type="text" onkeyup="addDetails('certification',this.value,2,'duration')"></td>
                    <td><input type="text" onkeyup="addDetails('certification',this.value,2,'Institute')"></td>
                </tr>
            </tbody>
        </table>
        <h4>Project :</h4>
        <table>
            <thead>
                <tr>
                    <td>#</td>
                    <td>title</td>
                    <td>duration</td>
                    <td>abstract</td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td><input type="text" onkeyup="addDetails('project',this.value,0,'title')"></td>
                    <td><input type="text" onkeyup="addDetails('project',this.value,0,'duration')"></td>
                    <td><input type="text" onkeyup="addDetails('project',this.value,0,'abstract')"></td>
                </tr>
                <tr>
                    <td>2</td>
                    <td><input type="text" onkeyup="addDetails('project',this.value,1,'title')"></td>
                    <td><input type="text" onkeyup="addDetails('project',this.value,1,'duration')"></td>
                    <td><input type="text" onkeyup="addDetails('project',this.value,1,'abstract')"></td>
                </tr>
                <tr>
                    <td>3</td>
                    <td><input type="text" onkeyup="addDetails('project',this.value,2,'title')"></td>
                    <td><input type="text" onkeyup="addDetails('project',this.value,2,'duration')"></td>
                    <td><input type="text" onkeyup="addDetails('project',this.value,2,'abstract')"></td>
                </tr>
            </tbody>
        </table>
        <h4>Experience :</h4>
        <table>
            <thead>
                <tr>
                    <td>#</td>
                    <td>company</td>
                    <td>role_of_working</td>
                    <td>year of experience</td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td><input type="text" onkeyup="addDetails('experience',this.value,0,'company')"></td>
                    <td><input type="text" onkeyup="addDetails('experience',this.value,0,'role')"></td>
                    <td><input type="text" onkeyup="addDetails('experience',this.value,0,'year')"></td>
                </tr>
                <tr>
                    <td>2</td>
                    <td><input type="text" onkeyup="addDetails('experience',this.value,1,'company')"></td>
                    <td><input type="text" onkeyup="addDetails('experience',this.value,1,'role')"></td>
                    <td><input type="text" onkeyup="addDetails('experience',this.value,1,'year')"></td>
                </tr>
                <tr>
                    <td>3</td>
                    <td><input type="text" onkeyup="addDetails('experience',this.value,2,'company')"></td>
                    <td><input type="text" onkeyup="addDetails('experience',this.value,2,'role')"></td>
                    <td><input type="text" onkeyup="addDetails('experience',this.value,2,'year')"></td>
                </tr>
            </tbody>
        </table>
        <h4>Personal Details</h4>
        <label>gender:</label><input onkeyup="addDetails('gender',this.value)" type="text"><br>
        <label>DOB:</label><input onkeyup="addDetails('dob',this.value)" type="date"><br>
        <label>age:</label><input onkeyup="addDetails('age',this.value)" type="number"><br>
        <label>Marrital Status:</label><input onkeyup="addDetails('marriage',this.value)" type="text"><br>
        <label>Father's Name :</label><input onkeyup="addDetails('father',this.value)" type="text"><br>
        <label>Mother's Name</label><input onkeyup="addDetails('mother',this.value)" type="text"><br>
        <label>address</label><textarea onkeyup="addDetails('address',this.value)" cols="25" rows="2"></textarea><br>
        <label>Nationality</label><input onkeyup="addDetails('Nationality',this.value)" type="text"><br>
        <h4>Language Known</h4>
                <input onkeyup="addDetails('language_known',this.value,0)" type="text">
                <input onkeyup="addDetails('language_known',this.value,1)" type="text">
                <input onkeyup="addDetails('language_known',this.value,2)" type="text">
       </form>
                <button id="main">submit</button>
                <!-- <button id="move">remove</button> -->
        <table id="user">
            <thead>
                <tr>
                    <th>SNo</th>
                    <th>id</th>
                    <th>name</th>
                    </tr>
            </thead>
           <tbody id="user1">

           </tbody>
        </table>
        <div>
            <code id="object"></code>
        </div>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script type="text/javascript">
         let user_detail={
        skills:[],
        education:[],
        certification:[],
        project:[],
        experience:[],
        language_known:[]
    };
     function addDetails(key,value,index=null,obj_key=null){
       if(index==null && obj_key==null){
       user_detail[key]=value;
        }
        else if(obj_key==null){
            user_detail[key][index]=value;
        }
        else{
            if(!user_detail[key][index]){
                user_detail[key][index]={};
            }
            user_detail[key][index][obj_key]=value;
        }
        
    }

        $(document).ready(function(){
            function view(){
                $.ajax({
                    type:"get",
                    url:"http://karka.academy/api/action.php",
                    data:{
                        request:"get_user_resume",
                        user:"natthiy"
                    },
                    success:function(items){
                    let add=JSON.parse(items).data;
                    $("#user1").html(``)
                    //let value=add.data;
                    let ele="";
                    for(let i=0;i<add.length;i++){
                    let obj=JSON.parse(add[i].data);
                    console.log(obj)
                     ele+="<tr><td>"+i+"</td><td>"+add[i].id+"</td><td>"+obj.name+"</td><td><button id='del' value="+add[i].id+">delete</button></td></td><td><button><a href=view.html?id="+add[i].id+">view</a></button></td></tr>";
                    
                    }
                    $("#user1").html(ele);  
                    },
                });
            }
           view();
            $("#main").click(function(){
                $.ajax({
                    type :"post",
                    url:"http://karka.academy/api/action.php",
            
                    data:{
                    request : "create_resume",
                    user: "natthiy",
                    resume:user_detail
                    },
                    success:function(items){
                        view();
                        console.log(items);
                    },
                    error:function(){
                        console.log("failed");
                    }
                });
                
            });
            
            $(document).on("click","#del",function(){
                let val=$(this).val();
                $.ajax({
                    type:"get",
                    url:"http://karka.academy/api/action.php",
                    data:{
                            request:"delete_user_resume",
                            user:"natthiy",
                            id:val
                        },
                    success:function(items){
                        view();
                        console.log(items);
                    },
            })

            })
            // $("#move").click(function(){
            //     $.ajax({
            //         type:"get",
            //         url:"http://karka.academy/api/action.php",
            //         data:{
            //                 request:"delete_user_resume",
            //                 user:"natthiy",
            //                 id:1388
            //             },
            //         success:function(items){
            //             //view();
            //             console.log(items);
            //         },
            // })

            //  })
            
           
        });
          
        
    </script>
</body>
</html>   